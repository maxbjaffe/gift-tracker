/**
 * Nickname Mappings Dictionary
 *
 * Maps common nicknames to their formal name equivalents.
 * Used to match casual references (e.g., "Liz") to formal names (e.g., "Elizabeth").
 */

/**
 * Dictionary mapping nicknames to their formal names
 * Key: nickname (lowercase), Value: formal name
 */
export const NICKNAME_TO_FORMAL: Record<string, string> = {
  // A names
  abe: 'abraham',
  al: 'albert',
  alex: 'alexander',
  allie: 'allison',
  andy: 'andrew',
  angie: 'angela',
  annie: 'anne',
  ari: 'ariel',
  art: 'arthur',

  // B names
  barb: 'barbara',
  bart: 'bartholomew',
  bea: 'beatrice',
  becca: 'rebecca',
  becky: 'rebecca',
  ben: 'benjamin',
  benny: 'benjamin',
  bert: 'albert',
  beth: 'elizabeth',
  betty: 'elizabeth',
  bev: 'beverly',
  bill: 'william',
  billy: 'william',
  bob: 'robert',
  bobby: 'robert',
  brad: 'bradley',
  bri: 'brianna',
  brit: 'brittany',

  // C names
  cal: 'calvin',
  cam: 'cameron',
  carly: 'caroline',
  carol: 'caroline',
  carrie: 'caroline',
  cass: 'cassandra',
  cassie: 'cassandra',
  cat: 'catherine',
  cate: 'catherine',
  cath: 'catherine',
  cathy: 'catherine',
  chad: 'chadwick',
  charlie: 'charles',
  chaz: 'charles',
  chip: 'charles',
  chris: 'christopher',
  christie: 'christine',
  christy: 'christine',
  chuck: 'charles',
  cindy: 'cynthia',
  cj: 'christopher',
  connie: 'constance',

  // D names
  daf: 'dafydd',
  dan: 'daniel',
  danny: 'daniel',
  dave: 'david',
  davy: 'david',
  deb: 'deborah',
  debbie: 'deborah',
  dee: 'diana',
  del: 'delores',
  dex: 'dexter',
  di: 'diana',
  dick: 'richard',
  dina: 'deanna',
  don: 'donald',
  donna: 'madonna',
  donnie: 'donald',
  dottie: 'dorothy',
  doug: 'douglas',
  drew: 'andrew',

  // E names
  ed: 'edward',
  eddie: 'edward',
  eddy: 'edward',
  eli: 'elijah',
  eliza: 'elizabeth',
  ellie: 'eleanor',
  em: 'emily',
  emma: 'emily',
  emmy: 'emily',
  eric: 'frederick',
  ernie: 'ernest',
  evie: 'evelyn',

  // F names
  fanny: 'frances',
  flo: 'florence',
  fran: 'frances',
  frank: 'francis',
  frankie: 'francis',
  fred: 'frederick',
  freddie: 'frederick',
  fritz: 'frederick',

  // G names
  gabe: 'gabriel',
  gail: 'abigail',
  gene: 'eugene',
  gerry: 'gerald',
  gil: 'gilbert',
  gina: 'regina',
  ginny: 'virginia',
  greg: 'gregory',
  gus: 'augustus',

  // H names
  hank: 'henry',
  harry: 'harold',
  helen: 'helena',

  // I names
  ike: 'isaac',
  izzy: 'isabella',

  // J names
  jack: 'john',
  jackie: 'jacqueline',
  jake: 'jacob',
  jamie: 'james',
  jan: 'janet',
  jane: 'janet',
  jay: 'jason',
  jaz: 'jasmine',
  jazz: 'jasmine',
  jb: 'john',
  jd: 'john',
  jeff: 'jeffrey',
  jen: 'jennifer',
  jenna: 'jennifer',
  jenny: 'jennifer',
  jer: 'jeremy',
  jerry: 'gerald',
  jess: 'jessica',
  jessie: 'jessica',
  jim: 'james',
  jimmy: 'james',
  jo: 'joanne',
  joe: 'joseph',
  joey: 'joseph',
  jon: 'jonathan',
  josh: 'joshua',
  jude: 'judith',
  judy: 'judith',
  jules: 'julia',
  julie: 'julia',

  // K names
  kat: 'katherine',
  kate: 'katherine',
  kath: 'katherine',
  katie: 'katherine',
  kathy: 'katherine',
  kay: 'katherine',
  ken: 'kenneth',
  kenny: 'kenneth',
  kev: 'kevin',
  kim: 'kimberly',
  kit: 'katherine',
  kitty: 'katherine',
  kris: 'kristina',
  krissy: 'kristina',

  // L names
  larry: 'lawrence',
  laura: 'laurence',
  laurie: 'laurence',
  len: 'leonard',
  lenny: 'leonard',
  leo: 'leonard',
  les: 'leslie',
  lester: 'leslie',
  lew: 'lewis',
  lex: 'alexander',
  liam: 'william',
  lib: 'elizabeth',
  libby: 'elizabeth',
  lil: 'lillian',
  lilly: 'lillian',
  linda: 'melinda',
  liz: 'elizabeth',
  liza: 'elizabeth',
  lizzie: 'elizabeth',
  lizzy: 'elizabeth',
  lou: 'louise',
  louie: 'louis',
  luce: 'lucy',
  lucy: 'lucille',
  luke: 'lucas',

  // M names
  mac: 'mackenzie',
  maddie: 'madeline',
  maddy: 'madeline',
  mag: 'margaret',
  maggie: 'margaret',
  mandy: 'amanda',
  marc: 'marcus',
  marcy: 'marcia',
  marge: 'margaret',
  margie: 'margaret',
  marty: 'martin',
  mat: 'matthew',
  matt: 'matthew',
  matty: 'matthew',
  max: 'maxwell',
  maxie: 'maxwell',
  meg: 'margaret',
  mel: 'melissa',
  mia: 'maria',
  mick: 'michael',
  mickey: 'michael',
  mike: 'michael',
  mikey: 'michael',
  milly: 'mildred',
  mindy: 'melinda',
  minnie: 'minerva',
  missy: 'melissa',
  mitch: 'mitchell',
  mo: 'maureen',
  molly: 'mary',
  monty: 'montgomery',

  // N names
  nan: 'nancy',
  nance: 'nancy',
  nancy: 'anne',
  nat: 'nathan',
  natalie: 'natalya',
  nate: 'nathan',
  ned: 'edward',
  nell: 'eleanor',
  nelly: 'eleanor',
  nick: 'nicholas',
  nicky: 'nicholas',
  nina: 'antonina',
  nora: 'eleanor',

  // O names
  ollie: 'oliver',

  // P names
  pat: 'patricia',
  patsy: 'patricia',
  patty: 'patricia',
  peg: 'margaret',
  peggy: 'margaret',
  penny: 'penelope',
  pete: 'peter',
  phil: 'philip',
  polly: 'mary',

  // Q names
  // (no common Q nicknames)

  // R names
  randy: 'randall',
  ray: 'raymond',
  ree: 'marie',
  reg: 'reginald',
  rich: 'richard',
  richie: 'richard',
  rick: 'richard',
  ricky: 'richard',
  rob: 'robert',
  robbie: 'robert',
  bobby: 'robert',
  rocky: 'rockwell',
  rod: 'rodney',
  roger: 'rodger',
  ron: 'ronald',
  ronnie: 'ronald',
  rosie: 'rose',
  roxy: 'roxanne',
  roy: 'leroy',
  russ: 'russell',

  // S names
  sal: 'salvador',
  sally: 'sarah',
  sam: 'samuel',
  sammie: 'samantha',
  sammy: 'samuel',
  sandy: 'sandra',
  sara: 'sarah',
  sasha: 'alexander',
  scott: 'prescott',
  sean: 'john',
  shawn: 'shawna',
  shelly: 'michelle',
  sheri: 'sheryl',
  sherry: 'sheryl',
  sid: 'sidney',
  sly: 'sylvester',
  stacy: 'anastasia',
  stan: 'stanley',
  steve: 'stephen',
  stevie: 'stephen',
  stu: 'stuart',
  sue: 'susan',
  suzie: 'susan',
  suzy: 'susan',
  syd: 'sydney',

  // T names
  tam: 'tamara',
  tammy: 'tamara',
  ted: 'theodore',
  teddy: 'theodore',
  terri: 'teresa',
  terry: 'terence',
  tess: 'teresa',
  theo: 'theodore',
  tia: 'tiana',
  tiff: 'tiffany',
  tim: 'timothy',
  timmy: 'timothy',
  tina: 'christina',
  toby: 'tobias',
  tom: 'thomas',
  tommy: 'thomas',
  tony: 'anthony',
  tori: 'victoria',
  tracey: 'teresa',
  tracy: 'teresa',
  trey: 'terrence',
  trina: 'catherine',
  trish: 'patricia',
  trisha: 'patricia',

  // U names
  // (no common U nicknames)

  // V names
  val: 'valentine',
  vicky: 'victoria',
  vinnie: 'vincent',
  vinny: 'vincent',

  // W names
  walt: 'walter',
  will: 'william',
  willie: 'william',
  willy: 'william',

  // X, Y, Z names
  zach: 'zachary',
  zack: 'zachary',
  zee: 'zelda',
};

/**
 * Relationship synonyms for matching
 * Maps common relationship terms to normalized forms
 */
export const RELATIONSHIP_SYNONYMS: Record<string, string[]> = {
  mother: ['mom', 'mama', 'mommy', 'ma', 'mum', 'mummy', 'mother'],
  father: ['dad', 'daddy', 'papa', 'pa', 'pop', 'father', 'pops'],
  sister: ['sis', 'sister', 'sissy'],
  brother: ['bro', 'brother', 'bruh'],
  grandmother: ['grandma', 'granny', 'nana', 'nanna', 'gram', 'grammy', 'grandmother', 'gma'],
  grandfather: ['grandpa', 'gramps', 'papa', 'pap', 'grandfather', 'gpa'],
  wife: ['wife', 'spouse', 'partner', 'wifey'],
  husband: ['husband', 'spouse', 'partner', 'hubby'],
  daughter: ['daughter'],
  son: ['son', 'boy'],
  aunt: ['aunt', 'auntie', 'aunty'],
  uncle: ['uncle'],
  cousin: ['cousin', 'cuz'],
  niece: ['niece'],
  nephew: ['nephew'],
  friend: ['friend', 'buddy', 'pal', 'bestie', 'bff'],
};

/**
 * Get formal name from nickname
 *
 * @param nickname - Nickname to look up
 * @returns Formal name if found, otherwise original input
 *
 * @example
 * getFormalName('liz') // 'elizabeth'
 * getFormalName('mike') // 'michael'
 * getFormalName('unknown') // 'unknown'
 */
export function getFormalName(nickname: string): string {
  const normalized = nickname.trim().toLowerCase();
  return NICKNAME_TO_FORMAL[normalized] || nickname;
}

/**
 * Check if a name is a known nickname
 *
 * @param name - Name to check
 * @returns True if name is in nickname dictionary
 *
 * @example
 * isNickname('liz') // true
 * isNickname('elizabeth') // false
 */
export function isNickname(name: string): boolean {
  const normalized = name.trim().toLowerCase();
  return normalized in NICKNAME_TO_FORMAL;
}

/**
 * Get normalized relationship from casual term
 *
 * @param term - Relationship term (e.g., "mom", "daddy")
 * @returns Normalized relationship (e.g., "mother", "father")
 *
 * @example
 * normalizeRelationship('mom') // 'mother'
 * normalizeRelationship('grandpa') // 'grandfather'
 */
export function normalizeRelationship(term: string): string | null {
  const normalized = term.trim().toLowerCase();

  for (const [formal, synonyms] of Object.entries(RELATIONSHIP_SYNONYMS)) {
    if (synonyms.includes(normalized)) {
      return formal;
    }
  }

  return null;
}

/**
 * Check if a term is a relationship keyword
 *
 * @param term - Term to check
 * @returns True if term is a relationship synonym
 *
 * @example
 * isRelationshipTerm('mom') // true
 * isRelationshipTerm('sarah') // false
 */
export function isRelationshipTerm(term: string): boolean {
  return normalizeRelationship(term) !== null;
}

/**
 * Get all possible nicknames for a formal name
 *
 * @param formalName - Formal name to find nicknames for
 * @returns Array of known nicknames
 *
 * @example
 * getNicknamesForName('elizabeth') // ['beth', 'betty', 'liz', 'lizzie', ...]
 */
export function getNicknamesForName(formalName: string): string[] {
  const normalized = formalName.trim().toLowerCase();
  const nicknames: string[] = [];

  for (const [nickname, formal] of Object.entries(NICKNAME_TO_FORMAL)) {
    if (formal === normalized) {
      nicknames.push(nickname);
    }
  }

  return nicknames;
}
